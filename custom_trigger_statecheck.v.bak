module custom_trigger_statecheck(
    input        acq_clk,
    input        reset,
    input [0:6]  data_in,     
    output reg   trigger_out
);

reg [0:3] prev_state;

wire [0:3] state = data_in[0:3];

wire invalid_range = (state > 4'd9);
wire wrong_sequence = (state != prev_state + 4'd1) && !(prev_state == 4'd9 && state == 4'd0);
wire unknown_data = (state === 4'bxxxx || state === 4'bzzzz );

always @(posedge acq_clk or posedge reset) begin
    if (reset) begin
        prev_state <= 4'd0;
        trigger_out <= 1'b0;
    end else begin

//kiểm tra nếu state ngoài các điều kiện case, giá trị dòng điện không xác định
//ktra nếu state không tăng tuần tự
        if (invalid_range || wrong_sequence || unknown_data)
            trigger_out <= 1'b1;
        else
            trigger_out <= 1'b0;

		  
        prev_state <= state;
    end
end

endmodule
